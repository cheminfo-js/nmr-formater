!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.nmrRange=n():t.nmrRange=n()}(this,function(){return function(t){function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){"use strict";function r(t,n,e,r,l,s){d(),i(t,l,s);for(var u=t.length,g=0;g<u;g++){if(n)var f=t[g];else var f=t[u-g-1];f&&(d(),a(f,e),o(f,r))}}function i(t,n,e){"NMR SPEC"==t.type?(e.nucleus&&(x+=p(e.nucleus)),x+=" NMR",(n||e.observe)&&(x+=" (",e.observe&&(x+=(1*e.observe).toFixed(0)+" MHz",n&&(x+=", ")),n&&(x+=c(n)),x+=")"),x+=" δ "):"IR"==t.type?x+=" IR ":"MASS"==t.type&&(x+=" MASS ")}function a(t,n){var e,r=0,i=0,a=0;t.from&&(r="string"==typeof t.from?parseFloat(t.from):t.from),t.to&&(i="string"==typeof t.to?parseFloat(t.to):t.to),t.signal[0].delta?a="string"==typeof t.signal[0].delta?parseFloat(t.signal[0].delta):t.signal[0].delta:e=!0,e===!0||"m"==t.signal[0].multiplicity&&b===!0?t.from&&t.to?x+=r<i?r.toFixed(n)+"-"+i.toFixed(n):i.toFixed(n)+"-"+r.toFixed(n):t.signal[0].delta&&(x+="?"):t.signal[0].delta?x+=a.toFixed(n):t.from&&t.to&&(x+=((r+i)/2).toFixed(n))}function o(t,n){v="",u(t),l(t),g(t,n),s(t),v.length>0&&(x+=" ("+v+")")}function l(t){t.pubIntegration?(h(),v+=t.pubIntegration):t.integral&&(h(),v+=t.integral.toFixed(0)+" H")}function s(t){t.signal[0].pubAssignment?(h(),v+=f(t.signal[0].pubAssignment)):t.signal[0].assignment&&(h(),v+=f(t.signal[0].assignment))}function u(t){t.signal[0].pubMultiplicity?(h(),v+=t.pubMultiplicity):t.signal[0].multiplicity&&(h(),v+=t.signal[0].multiplicity)}function g(t,n){if("sm".indexOf(t.signal[0].multiplicity)<0&&t.signal[0].j&&t.signal[0].j.length>0){for(var e=t.signal[0].j,r="<i>J</i> = ",i=0;i<e.length;i++){var a=e[i].coupling||0;r.length>11&&(r+=", "),r+=a.toFixed(n)}h(),v+=r+" Hz"}}function f(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>"),t=t.replace(/\"([^\"]*)\"/g,"<i>$1</i>")}function c(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>")}function p(t){return t=t.replace(/([0-9])/g,"<sup>$1</sup>")}function d(){x.length>0&&!x.match(/ $/)&&(x+=", ")}function h(){v.length>0&&!v.match(", $")&&(v+=", ")}var m=e(1),x="",v="",y="",b=!1;t.exports=e(2),t.exports.update=function(t){for(var n=0;n<t.length;n++)for(var e=t[n],r=0;r<e.signal.length;r++){var i=e.signal[r];if(i.j&&!i.multiplicity){i.multiplicity="";for(var a=0;a<i.j.length;a++)i.multiplicity+=i.j[a].multiplicity}}return t},t.exports.updateIntegrals=function(t,n){var e,r=n.factor||1;if(n.sum){var i=n.sum||1,a=0;for(e=0;e<t.length;e++)a+=Math.round(t[e].integral);r=i/a}for(e=0;e<t.length;e++)t[e].integral*=r;return t},t.exports.nmrJ=function(t,n){for(var e,r="",i=Object.assign({},{separator:", ",nbDecimal:2},n),a=0;a<t.length;a++)e=t[a],e.length>11&&(e+=i.separator),r+=e.multiplicity+" "+e.coupling.toFixed(i.nbDecimal);return r},t.exports.peak2Vector=function(t,n){var e=n||{},r=e.from,i=e.to,a=e.nbPoints||16384,o=e.fnName||"gaussian",l=e.nWidth||4;if(!r){r=Number.MAX_VALUE;for(var s=0;s<t.length;s++)t[s].x-t[s].width*l<r&&(r=t[s].x-t[s].width*l)}if(!i){i=Number.MIN_VALUE;for(var s=0;s<t.length;s++)t[s].x+t[s].width*l>i&&(i=t[s].x+t[s].width*l)}for(var u=new Array(a),g=new Array(a),f=(i-r)/(a-1),s=0;s<a;s++)u[s]=r+s*f,g[s]=0;var c="intensity";t[0].y&&(c="y");for(var s=0;s<t.length;s++){var p=t[s];if(p.x>r&&p.x<i){var d=Math.round((p.x-r)/f),h=Math.round(p.width*l/f);if("gaussian"==o)for(var m=d-h;m<d+h;m++)m>=0&&m<a&&(g[m]+=p[c]*Math.exp(-.5*Math.pow((p.x-u[m])/(p.width/2),2)));else for(var x=p[c]*Math.pow(p.width,2)/4,m=d-h;m<d+h;m++)m>=0&&m<a&&(g[m]+=x/(Math.pow(p.x-u[m],2)+Math.pow(p.width/2,2)))}}return{x:u,y:g}},t.exports.range2Vector=function(n,e){return t.exports.peak2Vector(t.exports.range2Peaks(n),e)},t.exports.range2Peaks=function(t){for(var n=[],e=0;e<t.length;e++)for(var r=t[e],i=0;i<r.signal.length;i++)n=n.concat(r.signal[i].peak);return n},t.exports.toACS=function(n,e){var i=JSON.parse(JSON.stringify(n));if(i[0].delta1)return m.toACS(i,e);i=t.exports.update(i),x="",v="",y="";var a=null;return e&&e.solvent&&(a=e.solvent),e&&void 0!=e.rangeForMultiplet&&(b=e.rangeForMultiplet),e&&e.ascending?i.sort(function(t,n){return n.from-t.from}):i.sort(function(t,n){return t.from-n.from}),i.type="NMR SPEC",e&&"1H"==e.nucleus&&r(i,!1,2,1,a,e),e&&"13C"==e.nucleus&&r(i,!1,1,0,a,e),x.length>0&&(x+="."),x},t.exports.toNMRSignal=function(t){return null}},function(t,n){"use strict";function e(t,n,e,o,l){p(),r(t,l);for(var s=t.length,u=0;u<s;u++){if(n)var g=t[u];else var g=t[s-u-1];g&&(p(),i(g,e),a(g,o))}}function r(t,n){"NMR SPEC"==t.type?(t[0].nucleus&&(h+=c(t[0].nucleus)),h+=" NMR",(n||t[0].observe)&&(h+=" (",t[0].observe&&(h+=(1*t[0].observe).toFixed(0)+" MHz",n&&(h+=", ")),n&&(h+=f(n)),h+=")"),h+=" δ "):"IR"==t.type?h+=" IR ":"MASS"==t.type&&(h+=" MASS ")}function i(t,n){var e=0,r=0,i=0;t.integralData.from&&(e="string"==typeof t.integralData.from?parseFloat(t.integralData.from):t.integralData.from),t.integralData.to&&(r="string"==typeof t.integralData.to?parseFloat(t.integralData.to):t.integralData.to),t.delta1&&(i="string"==typeof t.delta1?parseFloat(t.delta1):t.delta1),t.asymmetric===!0||"m"==t.multiplicity&&v===!0?t.integralData.from&&t.integralData.to?h+=e<r?e.toFixed(n)+"-"+r.toFixed(n):r.toFixed(n)+"-"+sttotoFixed(n):t.delta1&&(h+=i.toFixed(n)):t.delta1?h+=i.toFixed(n):t.integralData.from&&t.integralData.to&&(h+=((e+r)/2).toFixed(n))}function a(t,n){m="",s(t),o(t),u(t,n),l(t),m.length>0&&(h+=" ("+m+")")}function o(t){t.pubIntegration?(d(),m+=t.pubIntegration):t.integralData&&(d(),m+=t.integralData.value.toFixed(0)+" H")}function l(t){t.pubAssignment?(d(),m+=g(t.pubAssignment)):t.assignment&&(d(),m+=g(t.assignment))}function s(t){t.pubMultiplicity?(d(),m+=t.pubMultiplicity):t.multiplicity&&(d(),m+=t.multiplicity)}function u(t,n){if(t.nmrJs){for(var e="<i>J</i> = ",r=0;r<t.nmrJs.length;r++){var i=t.nmrJs[r].coupling;e.length>11&&(e+=", "),e+=i.toFixed(n)}d(),m+=e+" Hz"}}function g(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>"),t=t.replace(/\"([^\"]*)\"/g,"<i>$1</i>")}function f(t){return t=t.replace(/([0-9])/g,"<sub>$1</sub>")}function c(t){return t=t.replace(/([0-9])/g,"<sup>$1</sup>")}function p(){h.length>0&&!h.match(/ $/)&&(h+=", ")}function d(){m.length>0&&!m.match(", $")&&(m+=", ")}var h="",m="",x="",v=!1;t.exports.toACS=function(t,n){h="",m="",x="";var r=null;return n&&n.solvent&&(r=n.solvent),n&&void 0!=n.rangeForMultiplet&&(v=n.rangeForMultiplet),n&&n.ascending?t.sort(function(t,n){return n.delta1-t.delta1}):t.sort(function(t,n){return t.delta1-n.delta1}),t.type="NMR SPEC","1H"==t[0].nucleus?e(t,!1,2,1,r):"13C"==t[0].nucleus&&e(t,!1,1,0,r),h.length>0&&(h+="."),h}},function(t,n){"use strict";const e={lineWidth:1,frequency:400};t.exports.prediction2Ranges=function(t,n){const r=Object.assign({},e,n),i=t.length,a=new Array(i);var o,l,s,u,g,f,c;for(o=0;o<i;o++)a[t[o].diaIDs[0]]?a[t[o].diaIDs[0]].push(o):a[t[o].diaIDs[0]]=[o];const p=Object.keys(a),d=new Array(p.length);for(o=0;o<p.length;o++){if(s=a[p[o]],u=t[s[0]],g=0,c=u.j)for(l=0;l<c.length;l++)g+=c[l].coupling;for(g+=2*r.lineWidth,g/=r.frequency,d[o]={from:u.delta-g,to:u.delta+g,integral:1,signal:[t[s[0]]]},l=1;l<s.length;l++)d[o].signal.push(t[s[l]]),d[o].integral++}for(o=0;o<d.length;o++)for(d[o]._highlight=d[o].signal[0].diaIDs,f=(d[o].from+d[o].to)/2,g=Math.abs(d[o].from-d[o].to),l=d.length-1;l>o;l--)Math.abs(f-(d[l].from+d[l].to)/2)<=Math.abs(g+Math.abs(d[l].from-d[l].to))/2&&(d[o].from=Math.min(d[o].from,d[l].from),d[o].to=Math.max(d[o].to,d[l].to),d[o].integral=d[o].integral+d[l].integral,d[o]._highlight.push(d[l].signal[0].diaIDs[0]),d.splice(l,1),l=d.length-1,f=(d[o].from+d[o].to)/2,g=Math.abs(d[o].from-d[o].to));return d}}])});
//# sourceMappingURL=nmr-range.min.js.map