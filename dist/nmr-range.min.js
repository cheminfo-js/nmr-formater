(function(d,e){'object'==typeof exports&&'object'==typeof module?module.exports=e():'function'==typeof define&&define.amd?define([],e):'object'==typeof exports?exports.nmrRange=e():d.nmrRange=e()})(this,function(){return function(c){function d(f){if(e[f])return e[f].exports;var g=e[f]={exports:{},id:f,loaded:!1};return c[f].call(g.exports,g,g.exports,d),g.loaded=!0,g.exports}var e={};return d.m=c,d.c=e,d.p='',d(0)}([function(c,d,e){'use strict';function f(C,D,E,F,G,H){t(),g(C,G,H);for(var I=C.length,J=0;J<I;J++){if(D)var K=C[J];else var K=C[I-J-1];K&&(t(),h(K,E),l(K,F))}}function g(C,D,E){'NMR SPEC'==C.type?(E.nucleus&&(z+=s(E.nucleus)),z+=' NMR',(D||E.observe)&&(z+=' (',E.observe&&(z+=(1*E.observe).toFixed(0)+' MHz',D&&(z+=', ')),D&&(z+=r(D)),z+=')'),z+=' δ '):'IR'==C.type?z+=' IR ':'MASS'==C.type&&(z+=' MASS ')}function h(C,D){var H,E=0,F=0,G=0;C.from&&('string'==typeof C.from?E=parseFloat(C.from):E=C.from),C.to&&('string'==typeof C.to?F=parseFloat(C.to):F=C.to),C.signal[0].delta?'string'==typeof C.signal[0].delta?G=parseFloat(C.signal[0].delta):G=C.signal[0].delta:H=!0,!0===H||'m'==C.signal[0].multiplicity&&!0===B?C.from&&C.to?E<F?z+=E.toFixed(D)+'-'+F.toFixed(D):z+=F.toFixed(D)+'-'+E.toFixed(D):C.signal[0].delta&&(z+='?'):C.signal[0].delta?z+=G.toFixed(D):C.from&&C.to&&(z+=((E+F)/2).toFixed(D))}function l(C,D){A='',o(C),m(C),p(C,D),n(C),0<A.length&&(z+=' ('+A+')')}function m(C){C.pubIntegration?(u(),A+=C.pubIntegration):C.integral&&(u(),A+=C.integral.toFixed(0)+' H')}function n(C){C.signal[0].pubAssignment?(u(),A+=q(C.signal[0].pubAssignment)):C.signal[0].assignment&&(u(),A+=q(C.signal[0].assignment))}function o(C){C.signal[0].pubMultiplicity?(u(),A+=C.pubMultiplicity):C.signal[0].multiplicity&&(u(),A+=C.signal[0].multiplicity)}function p(C,D){if(0>'sm'.indexOf(C.signal[0].multiplicity)&&C.signal[0].j&&0<C.signal[0].j.length){for(var E=C.signal[0].j,F='<i>J</i> = ',G=0;G<E.length;G++){var H=E[G].coupling||0;11<F.length&&(F+=', '),F+=H.toFixed(D)}u(),A+=F+' Hz'}}function q(C){return C=C.replace(/([0-9])/g,'<sub>$1</sub>'),C=C.replace(/\"([^\"]*)\"/g,'<i>$1</i>'),C}function r(C){return C=C.replace(/([0-9])/g,'<sub>$1</sub>'),C}function s(C){return C=C.replace(/([0-9])/g,'<sup>$1</sup>'),C}function t(){0<z.length&&!z.match(/ $/)&&(z+=', ')}function u(){0<A.length&&!A.match(', $')&&(A+=', ')}var v=e(1),z='',A='',B=!1;c.exports=e(2),c.exports.update=function(C){for(var D=0;D<C.length;D++)for(var E=C[D],F=0;F<E.signal.length;F++){var G=E.signal[F];if(G.j&&!G.multiplicity){G.multiplicity='';for(var H=0;H<G.j.length;H++)G.multiplicity+=G.j[H].multiplicity}}return C},c.exports.updateIntegrals=function(C,D){var E=D.factor||1,F;if(D.sum){var G=D.sum||1,H=0;for(F=0;F<C.length;F++)H+=Math.round(C[F].integral);E=G/H}for(F=0;F<C.length;F++)C[F].integral*=E;return C},c.exports.nmrJ=function(C,D){for(var G,E='',F=Object.assign({},{separator:', ',nbDecimal:2},D),H=0;H<C.length;H++)G=C[H],11<G.length&&(G+=F.separator),E+=G.multiplicity+' '+G.coupling.toFixed(F.nbDecimal);return E},c.exports.peak2Vector=function(C,D){var E=D||{},F=E.from,G=E.to,H=E.nbPoints||16384,I=E.fnName||'gaussian',J=E.nWidth||4;if(!F){F=Number.MAX_VALUE;for(var K=0;K<C.length;K++)C[K].x-C[K].width*J<F&&(F=C[K].x-C[K].width*J)}if(!G){G=Number.MIN_VALUE;for(var K=0;K<C.length;K++)C[K].x+C[K].width*J>G&&(G=C[K].x+C[K].width*J)}for(var L=Array(H),M=Array(H),N=(G-F)/(H-1),K=0;K<H;K++)L[K]=F+K*N,M[K]=0;var O='intensity';C[0].y&&(O='y');for(var K=0;K<C.length;K++){var P=C[K];if(P.x>F&&P.x<G){var Q=Math.round((P.x-F)/N),R=Math.round(P.width*J/N);if('gaussian'==I)for(var S=Q-R;S<Q+R;S++)0<=S&&S<H&&(M[S]+=P[O]*Math.exp(-0.5*Math.pow((P.x-L[S])/(P.width/2),2)));else for(var T=P[O]*Math.pow(P.width,2)/4,S=Q-R;S<Q+R;S++)0<=S&&S<H&&(M[S]+=T/(Math.pow(P.x-L[S],2)+Math.pow(P.width/2,2)))}}return{x:L,y:M}},c.exports.range2Vector=function(C,D){return c.exports.peak2Vector(c.exports.range2Peaks(C),D)},c.exports.range2Peaks=function(C){for(var D=[],E=0;E<C.length;E++)for(var F=C[E],G=0;G<F.signal.length;G++)D=D.concat(F.signal[G].peak);return D},c.exports.toACS=function(C,D){var E=JSON.parse(JSON.stringify(C));if(E[0].delta1)return v.toACS(E,D);E=c.exports.update(E),z='',A='';var F=null;return D&&D.solvent&&(F=D.solvent),D&&void 0!=D.rangeForMultiplet&&(B=D.rangeForMultiplet),D&&D.ascending?E.sort(function(G,H){return H.from-G.from}):E.sort(function(G,H){return G.from-H.from}),E.type='NMR SPEC',D&&'1H'==D.nucleus&&f(E,!1,2,1,F,D),D&&'13C'==D.nucleus&&f(E,!1,1,0,F,D),0<z.length&&(z+='.'),z},c.exports.toNMRSignal=function(C){return null}},function(c,d){'use strict';function e(A,B,C,D,E){s(),f(A,E);for(var F=A.length,G=0;G<F;G++){if(B)var H=A[G];else var H=A[F-G-1];H&&(s(),g(H,C),h(H,D))}}function f(A,B){'NMR SPEC'==A.type?(A[0].nucleus&&(u+=r(A[0].nucleus)),u+=' NMR',(B||A[0].observe)&&(u+=' (',A[0].observe&&(u+=(1*A[0].observe).toFixed(0)+' MHz',B&&(u+=', ')),B&&(u+=q(B)),u+=')'),u+=' δ '):'IR'==A.type?u+=' IR ':'MASS'==A.type&&(u+=' MASS ')}function g(A,B){var C=0,D=0,E=0;A.integralData.from&&('string'==typeof A.integralData.from?C=parseFloat(A.integralData.from):C=A.integralData.from),A.integralData.to&&('string'==typeof A.integralData.to?D=parseFloat(A.integralData.to):D=A.integralData.to),A.delta1&&('string'==typeof A.delta1?E=parseFloat(A.delta1):E=A.delta1),!0===A.asymmetric||'m'==A.multiplicity&&!0===z?A.integralData.from&&A.integralData.to?C<D?u+=C.toFixed(B)+'-'+D.toFixed(B):u+=D.toFixed(B)+'-'+sttotoFixed(B):A.delta1&&(u+=E.toFixed(B)):A.delta1?u+=E.toFixed(B):A.integralData.from&&A.integralData.to&&(u+=((C+D)/2).toFixed(B))}function h(A,B){v='',n(A),l(A),o(A,B),m(A),0<v.length&&(u+=' ('+v+')')}function l(A){A.pubIntegration?(t(),v+=A.pubIntegration):A.integralData&&(t(),v+=A.integralData.value.toFixed(0)+' H')}function m(A){A.pubAssignment?(t(),v+=p(A.pubAssignment)):A.assignment&&(t(),v+=p(A.assignment))}function n(A){A.pubMultiplicity?(t(),v+=A.pubMultiplicity):A.multiplicity&&(t(),v+=A.multiplicity)}function o(A,B){if(A.nmrJs){for(var C='<i>J</i> = ',D=0;D<A.nmrJs.length;D++){var E=A.nmrJs[D].coupling;11<C.length&&(C+=', '),C+=E.toFixed(B)}t(),v+=C+' Hz'}}function p(A){return A=A.replace(/([0-9])/g,'<sub>$1</sub>'),A=A.replace(/\"([^\"]*)\"/g,'<i>$1</i>'),A}function q(A){return A=A.replace(/([0-9])/g,'<sub>$1</sub>'),A}function r(A){return A=A.replace(/([0-9])/g,'<sup>$1</sup>'),A}function s(){0<u.length&&!u.match(/ $/)&&(u+=', ')}function t(){0<v.length&&!v.match(', $')&&(v+=', ')}var u='',v='',z=!1;c.exports.toACS=function(A,B){u='',v='';var C=null;return B&&B.solvent&&(C=B.solvent),B&&void 0!=B.rangeForMultiplet&&(z=B.rangeForMultiplet),B&&B.ascending?A.sort(function(D,E){return E.delta1-D.delta1}):A.sort(function(D,E){return D.delta1-E.delta1}),A.type='NMR SPEC','1H'==A[0].nucleus?e(A,!1,2,1,C):'13C'==A[0].nucleus&&e(A,!1,1,0,C),0<u.length&&(u+='.'),u}},function(c,d){'use strict';const e={lineWidth:1,frequency:400};c.exports.prediction2Ranges=function(f,g){const h=Object.assign({},e,g),l=f.length,m=Array(l);var n,o,p,q,r,s,t;for(n=0;n<l;n++)m[f[n].diaIDs[0]]?m[f[n].diaIDs[0]].push(n):m[f[n].diaIDs[0]]=[n];const u=Object.keys(m),v=Array(u.length);for(n=0;n<u.length;n++){if(p=m[u[n]],q=f[p[0]],r=0,t=q.j,t)for(o=0;o<t.length;o++)r+=t[o].coupling;for(r+=2*h.lineWidth,r/=h.frequency,v[n]={from:q.delta-r,to:q.delta+r,integral:1,signal:[f[p[0]]]},o=1;o<p.length;o++)v[n].signal.push(f[p[o]]),v[n].integral++}for(n=0;n<v.length;n++)for(v[n]._highlight=v[n].signal[0].diaIDs,s=(v[n].from+v[n].to)/2,r=Math.abs(v[n].from-v[n].to),o=v.length-1;o>n;o--)Math.abs(s-(v[o].from+v[o].to)/2)<=Math.abs(r+Math.abs(v[o].from-v[o].to))/2&&(v[n].from=Math.min(v[n].from,v[o].from),v[n].to=Math.max(v[n].to,v[o].to),v[n].integral=v[n].integral+v[o].integral,v[n]._highlight.push(v[o].signal[0].diaIDs[0]),v.splice(o,1),o=v.length-1,s=(v[n].from+v[n].to)/2,r=Math.abs(v[n].from-v[n].to));return v}}])});;
//# sourceMappingURL=nmr-range.min.js.map